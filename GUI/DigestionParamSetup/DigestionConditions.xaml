<UserControl x:Class="GUI.DigestionConditions"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:GUI"
             xmlns:guiFunctions="clr-namespace:GuiFunctions;assembly=GuiFunctions"
             mc:Ignorable="d" 
             d:DesignHeight="450" d:DesignWidth="800">
    <UserControl.Resources>
        <SolidColorBrush x:Key="DataGridHeaderColor" Color="#F9690E" />
        <SolidColorBrush x:Key="DataGridBackgroundColor" Color="#D5D5D5" />
        <SolidColorBrush x:Key="BackgroundColor" Color="#D5D5D5" />
        <SolidColorBrush x:Key="TextColor1" Color="#131313" />
        <SolidColorBrush x:Key="BorderColor" Color="#444449" />
        <SolidColorBrush x:Key="AccentColor" Color="#F9690E" />
        <Style x:Key="SmallHeaderLabelStyle" TargetType="Label">
            <Setter Property="HorizontalAlignment" Value="Left"/>
            <Setter Property="FontSize" Value="15"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Foreground" Value="{StaticResource TextColor1}"/>
            <Setter Property="Margin" Value="5,2,0,0"/>
        </Style>
        <Style x:Key="DataGridColumnHeaderStyle" TargetType="DataGridColumnHeader">
            <Setter Property="Background" Value="{StaticResource DataGridHeaderColor}"/>
            <Setter Property="FontSize" Value="13" />
        </Style>
        <Style x:Key="x:DataGridStyle" TargetType="DataGrid">
            <Setter Property="Foreground" Value="{StaticResource TextColor1}"/>
            <Setter Property="Background" Value="{StaticResource DataGridBackgroundColor}"/>
            <Setter Property="Height" Value="Auto"/>
            <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="BorderBrush" Value="{StaticResource BorderColor}"/>
            <Setter Property="Margin" Value="10,0,10,10"/>
            <Setter Property="SelectedItem" Value="{Binding SelectedRow, Mode=TwoWay}"/>
            <Setter Property="HeadersVisibility" Value="Column"/>
            <Setter Property="HorizontalGridLinesBrush" Value="{StaticResource DataGridHeaderColor}"/>
            <Setter Property="VerticalGridLinesBrush" Value="{StaticResource DataGridHeaderColor}"/>
            <Setter Property="AutoGenerateColumns" Value="False"/>
        </Style>
        <!--Styling for the grid that defines each page-->
        <Style x:Key="PageGridStyle" TargetType="Grid">
            <Setter Property="Background" Value="{StaticResource BackgroundColor}"/>
            <Setter Property="Margin" Value="-3,-2,-2,-2"/>
        </Style>
        <!--Styling for the "important" buttons like add task, add DB, etc.-->
        <Style x:Key="ImportantButtonStyle" TargetType="Button">
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Width" Value="200"/>
            <Setter Property="Background" Value="{StaticResource AccentColor}"/>
            <Setter Property="Foreground" Value="{StaticResource TextColor1}"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" BorderBrush="#131313" BorderThickness="1">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#f58c49"/>
                    <Setter Property="BorderBrush" Value="#131313"/>
                    <Setter Property="Foreground" Value="#131313"/>
                </Trigger>
            </Style.Triggers>
        </Style>
        <Style x:Key="TextBlockStyle" TargetType="TextBlock">
            <Setter Property="Foreground" Value="{StaticResource TextColor1}"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="TextWrapping" Value="WrapWithOverflow" />
            <Setter Property="Margin" Value="15,0,10,0"/>
        </Style>
        <Style x:Key="HeaderLabelStyle" TargetType="Label">
            <Setter Property="HorizontalAlignment" Value="Left"/>
            <Setter Property="FontSize" Value="26"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Foreground" Value="{StaticResource TextColor1}"/>
            <Setter Property="Margin" Value="10,5,0,0"/>
        </Style>
        <!--Styling for the big text header at the top of each page-->
        <Style x:Key="SubHeaderLabelStyle" TargetType="Label">
            <Setter Property="HorizontalAlignment" Value="Left"/>
            <Setter Property="FontSize" Value="19"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Foreground" Value="{StaticResource TextColor1}"/>
            <Setter Property="Margin" Value="10,5,0,0"/>
        </Style>
        <!--Styling for the grid that defines each page-->
        <Style x:Key="InternalGridStyle" TargetType="Grid">
            <Setter Property="Background" Value="{StaticResource BackgroundColor}"/>
            <Setter Property="Margin" Value="0,0,0,0"/>
        </Style>
    </UserControl.Resources>

    <Grid Style="{StaticResource PageGridStyle}" d:DataContext="{d:DesignInstance guiFunctions:DigestionConditionsSetupViewModel, IsDesignTimeCreatable=False}">
        <Grid.RowDefinitions>
            <!-- Header -->
            <RowDefinition Height="Auto"/>
            <!-- Main Content -->
            <RowDefinition Height="*"/>
            <!-- Bottom Buttons -->
            <RowDefinition Height="35"/>
        </Grid.RowDefinitions>

        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="2*"/>
            <ColumnDefinition Width="Auto"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <!-- Header -->
        <StackPanel Grid.Column="0" Grid.Row="0" Grid.ColumnSpan="3">

            <!--Header label-->
            <Label Content="Digestion Conditions" Grid.Row="0" Style="{StaticResource HeaderLabelStyle}" />

            <!--Detail text-->
            <TextBlock Grid.Row="1" Style="{StaticResource TextBlockStyle}">
                Set the proteases and digestion parameters to use for the in silico analysis.
            </TextBlock>
        </StackPanel>


        <!-- Main Content - Left Side -->
        <Grid Grid.Column="0" Grid.Row="1"  Margin="4 2"
              Background="{StaticResource DataGridBackgroundColor}">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
                <RowDefinition Height="35" />
            </Grid.RowDefinitions>

            <!--SubHeader label-->
            <Label Content="Proteases" Grid.Row="0"  Style="{StaticResource SubHeaderLabelStyle}" />

            <!-- Protease Selection ListBox with ItemsControl showing ProteaseSpecificDigestionControl -->
            <ScrollViewer VerticalScrollBarVisibility="Visible" HorizontalScrollBarVisibility="Auto" Grid.Row="1" Margin="2 0 2 8">
                <ItemsControl ItemsSource="{Binding ProteaseSpecificParameters}">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <local:ProteaseSpecificDigestionControl />
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </ScrollViewer>

            <!-- Buttons -->
            <Grid Grid.Row="2" Style="{StaticResource InternalGridStyle}"
                  Background="{StaticResource DataGridBackgroundColor}">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="2" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="2" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
                <Button Grid.Column="0" x:Name="defaultProteasesButton" Content="Default Proteases" Width="130"
                            Command="{Binding SetDefaultProteasesCommand}"  Style="{StaticResource ImportantButtonStyle}" />
                <Button Grid.Column="2" x:Name="clearProteasesButton" Content="Clear Protease Selection" Width="150"
                            Command="{Binding ClearProteasesCommand}"  Style="{StaticResource ImportantButtonStyle}" />
                <Button Grid.Column="4" x:Name="addCustomProteasesButton" Content="Add Custom Protease" Width="130"
                        Click="AddCustomProtease_Click"  Style="{StaticResource ImportantButtonStyle}" />
            </Grid>
        </Grid>

        <!-- GridSplitter -->
        <GridSplitter Grid.Column="1" Grid.Row="1" Width="5" HorizontalAlignment="Center" Background="lightgray" />

        <!-- Main Content - Right Side -->
        <Grid Grid.Column="2" Grid.Row="1" Margin="4 2"
              Background="{StaticResource DataGridBackgroundColor}">
            <DockPanel
                Background="{StaticResource DataGridBackgroundColor}">
                <GroupBox Header="Apply To All Proteases"
                          DockPanel.Dock="Top"
                          BorderThickness="2"
                          Foreground="{StaticResource TextColor1}"
                          BorderBrush="{StaticResource BorderColor}">
                    <Grid
                        Background="{StaticResource DataGridBackgroundColor}">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*" />
                            <RowDefinition Height="*" />
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>

                        <!-- Max missed cleavages -->
                        <StackPanel Orientation="Horizontal" Margin="5 5 5 0" Grid.Row="0">
                            <Label x:Name="maxMissedCleavagesLabel" Content="Max Missed Cleavages:" Width="150" />
                            <local:IntegerTextBoxControl x:Name="MissedCleavagesTextBox" 
                                                     Text="{Binding MaxMissedCleavages, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"
                                                     AllowNegative="False" Width="45">
                                <TextBox.ToolTip>
                                    <TextBlock>
                                    Maximum number of missed proteolytic cleavages allowed.
                                    <LineBreak />
                                    Semi-specific cleavages do not count toward this.
                                    </TextBlock>
                                </TextBox.ToolTip>
                            </local:IntegerTextBoxControl>
                        </StackPanel>

                        <!-- Min peptide lengths -->
                        <StackPanel Orientation="Horizontal" Margin="5 5 5 0" Grid.Row="1"
                                Background="{StaticResource DataGridBackgroundColor}">
                            <Label x:Name="lblMinPeptideLength" Content="Min Peptide Length:" Width="150" />
                            <local:IntegerTextBoxControl x:Name="MinPeptideLengthTextBox" 
                                                     Text="{Binding MinLength, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"
                                                     AllowNegative="False" Width="45" 
                                                     ToolTipService.ShowDuration="999999" 
                                                     ToolTipService.InitialShowDelay="500">
                                <TextBox.ToolTip>
                                    <TextBlock>
                                    The minimum allowed peptide length. Must be a positive, non-zero integer.
                                    </TextBlock>
                                </TextBox.ToolTip>
                            </local:IntegerTextBoxControl>
                        </StackPanel>

                        <!-- Max peptide lengths -->
                        <StackPanel Orientation="Horizontal" Margin="5 5 5 0" Grid.Row="2"
                                Background="{StaticResource DataGridBackgroundColor}">
                            <Label x:Name="lblMaxPeptideLength" Content="Max Peptide Length:" Width="150" />
                            <local:IntegerTextBoxControl x:Name="MaxPeptideLengthTextBox" 
                                                     Text="{Binding MaxLength, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"
                                                     AllowNegative="False" Width="45">
                                <TextBox.ToolTip>
                                    <TextBlock>
                                    The maximum allowed peptide length. Leave empty for no limitation.
                                    </TextBlock>
                                </TextBox.ToolTip>
                            </local:IntegerTextBoxControl>
                        </StackPanel>
                    </Grid>
                </GroupBox>
                <GroupBox Header="Global Parameters" 
                          BorderThickness="2"
                          DockPanel.Dock="Top"
                          Foreground="{StaticResource TextColor1}"
                          BorderBrush="{StaticResource BorderColor}">
                    <Grid Background="{StaticResource DataGridBackgroundColor}">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*" />
                            <RowDefinition Height="*" />
                            <RowDefinition Height="*" />
                            <RowDefinition Height="*" />
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>
                        <StackPanel Orientation="Horizontal" Margin="5 5 5 0"  Grid.Row="0"
                                Background="{StaticResource DataGridBackgroundColor}">
                            <CheckBox x:Name="ModPepsAreUnique" 
                                  IsChecked="{Binding TreatModifiedPeptidesAsDifferent, Mode=TwoWay}"
                                  Content="Treat modified peptides as different peptides">
                                <ToolTipService.ToolTip>
                                    <ToolTip Content="Modified forms of a peptide base sequence are treated as different"
                                         ToolTipService.ShowDuration="999999" ToolTipService.InitialShowDelay="500" />
                                </ToolTipService.ToolTip>
                            </CheckBox>
                        </StackPanel>

                        <StackPanel Orientation="Horizontal" Margin="5 5 5 0" Grid.Row="1"
                                    Background="{StaticResource DataGridBackgroundColor}">
                            <CheckBox x:Name="FixedCarbamido" 
                                      IsChecked="{Binding ApplyFixedCarbamidomethylation, Mode=TwoWay}"
                                      Content="Apply Fixed Carbamidomethylation of C">
                                <ToolTipService.ToolTip>
                                    <ToolTip Content="All Cysteines will be treated as if they were carbamidomethylated"
                                             ToolTipService.ShowDuration="999999" ToolTipService.InitialShowDelay="500" />
                                </ToolTipService.ToolTip>
                            </CheckBox>
                        </StackPanel>

                        <StackPanel Orientation="Horizontal" Margin="5 5 5 0" Grid.Row="2"
                                    Background="{StaticResource DataGridBackgroundColor}">
                            <CheckBox x:Name="VariableOx" 
                                      IsChecked="{Binding ApplyVariableOxidation, Mode=TwoWay}"
                                      Content="Apply Variable Oxidation of M">
                                <ToolTipService.ToolTip>
                                    <ToolTip
                                        Content="All Methionines will be treated as oxidized and un-oxidized generating two peptides with differing base sequences"
                                        ToolTipService.ShowDuration="999999" ToolTipService.InitialShowDelay="500" />
                                </ToolTipService.ToolTip>
                            </CheckBox>
                        </StackPanel>

                        <!-- Min peptide mass -->
                        <StackPanel Orientation="Horizontal" Margin="5 5 5 0" Grid.Row="3"
                                Background="{StaticResource DataGridBackgroundColor}">
                            <Label x:Name="lblMinPeptideMass" Content="Min Peptide Mass:" Width="150" />
                            <local:IntegerTextBoxControl x:Name="MinPeptideMassTextBox" 
                                                     Text="{Binding MinPeptideMass, Mode=TwoWay}"
                                                     Width="45">
                                <TextBox.ToolTip>
                                    <TextBlock>
                                    Optional: The minimum allowed peptide mass. Leave empty for no limitation.
                                    </TextBlock>
                                </TextBox.ToolTip>
                            </local:IntegerTextBoxControl>
                        </StackPanel>

                        <!-- Max peptide mass -->
                        <StackPanel Orientation="Horizontal" Margin="5 5 5 0" Grid.Row="4"
                                Background="{StaticResource DataGridBackgroundColor}">
                            <Label x:Name="lblMaxPeptideMass" Content="Max Peptide Mass:" Width="150" />
                            <local:IntegerTextBoxControl x:Name="MaxPeptideMassTextBox" 
                                                     Text="{Binding MaxPeptideMass, Mode=TwoWay}"
                                                     Width="45">
                                <TextBox.ToolTip>
                                    <TextBlock>
                                    Optional: The maximum allowed peptide mass. Leave empty for no limitation.
                                    </TextBlock>
                                </TextBox.ToolTip>
                            </local:IntegerTextBoxControl>
                        </StackPanel>
                    </Grid>
                </GroupBox>

                <Button DockPanel.Dock="Bottom"  x:Name="ResetDigestionTask" Content="Reset Digestion Conditions" MinHeight="34" Margin=" 4 0"
                        VerticalAlignment="Bottom" HorizontalAlignment="Center"
                        Command="{Binding ResetDigestionConditionsCommand}"
                        Style="{StaticResource ImportantButtonStyle}"/>
            </DockPanel>
        </Grid>
    </Grid>
</UserControl>
